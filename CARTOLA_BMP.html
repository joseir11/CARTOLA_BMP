<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TAÇA NATTOS 2026</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&family=Teko:wght@600;700&display=swap" rel="stylesheet">

<style>
/* CONFIGURAÇÕES DE CORES E VARIÁVEIS GLOBAIS */
:root {
  --green: #22c55e;
  --red: #ef4444;
  --orange: #f59e0b;
  --bg: #1f2937;
  --topo-grad: linear-gradient(135deg, #111827, #1f2937);
  --text-light: #e5e7eb;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Inter', sans-serif;
  background: var(--bg);
  color: #fff;
  -webkit-tap-highlight-color: transparent;
}

/* ESTILIZAÇÃO DO CABEÇALHO E CONTROLES */
.header {
  display: flex;
  flex-direction: column;
  padding: 15px;
  background: var(--topo-grad);
  gap: 12px;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}

.header-topo-mobile { display: flex; align-items: center; gap: 12px; }
.titulo-principal { font-size: 32px; font-weight: 900; color: var(--text-light); }
.logo-campeonato { height: 55px; width: auto; }

.header-controles-mobile { display: flex; align-items: center; justify-content: space-between; }
.toggle-visual { width: 90px; background: rgba(255,255,255,0.1); border-radius: 999px; padding: 3px; display: flex; justify-content: space-between;}

.toggle-btn { 
  width: 36px;
  height: 36px; 
  border-radius: 50%; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  cursor: pointer; 
  border: none; 
  background: transparent; 
  color: #9ca3af; 
}

.toggle-btn.ativo { background: var(--orange); color: #000; }
.icon-vertical { transform: rotate(90deg); }

.badge-rdd { display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.06); padding: 0 12px; border-radius: 999px; height: 38px; }
.bola-rdd { width: 28px; height: 28px; border-radius: 50%; background: var(--orange); display: flex; align-items: center; justify-content: center; font-weight: 900; color: #000; font-size: 10px; }
.texto-rdd { font-weight: 800; font-size: 16px; color: var(--text-light); }

/* ESTILIZAÇÃO DO CAMPO DE JOGO */
.campo {
  position: relative;
  margin: 0 auto;
  width: 95%;
  max-width: 520px;
  aspect-ratio: 9/14;
  border-radius: 20px;
  overflow: visible;
  background: #0f172a url("./campo.png") center/cover no-repeat;
  border: 2px solid rgba(34,197,94,0.2);
}

/* CARDS DOS TIMES NO CAMPO */
.card-time {
  position: absolute;
  width: 100px;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: 10;
}

.logo-campo { width: 78px; height: 78px; object-fit: contain; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.6)); }

.badge-pontos-campo {
  background: var(--orange);
  color: #000;
  font-weight: 900;
  font-size: 13px;
  padding: 3px 8px;
  border-radius: 20px;
  margin-top: 2px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  gap: 5px;
  cursor: pointer;
}

.badge-lider { background: var(--green) !important; color: white !important; }
.badge-rebaixamento { background: var(--red) !important; color: white !important; }

.posicao-campo {
  position: absolute;
  top: -10px; 
  right: -5px; 
  font-family: 'Teko'; 
  font-size: 28px; 
  text-shadow: 2px 2px 3px #000;
  z-index: 20;
}

.trofeu-campo {
  position: absolute;
  width: 38px;
  transform: translate(-50%, -50%);
  z-index: 5;
  pointer-events: none;
  filter: drop-shadow(0 4px 10px rgba(0,0,0,0.5));
}

.garcom {
  position: absolute;
  width: 65px;
  transform: translate(-180%, -40%);
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.5));
  z-index: 5;
}

/* CARD DE DETALHES FLUTUANTE - Z-INDEX ALTO PARA SOBREPOSIÇÃO TOTAL */
.pop-detalhes {
  position: absolute;
  bottom: 115%;
  left: 50%;
  transform: translateX(-50%);
  background: white;
  color: #1f2937;
  padding: 10px;
  border-radius: 8px;
  width: 160px;
  font-size: 10px;
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
  z-index: 999;
  display: none;
}
.pop-detalhes b { color: #000; display: block; border-bottom: 1px solid #eee; margin-bottom: 4px; font-size: 11px; text-align: center; }
.pop-grid-header { display: grid; grid-template-columns: 25px 1fr 1fr 1fr; font-weight: 800; color: #64748b; border-bottom: 1px solid #eee; padding-bottom: 2px; margin-bottom: 2px; text-align: center; }
.pop-grid-row { display: grid; grid-template-columns: 25px 1fr 1fr 1fr; text-align: center; padding: 2px 0; border-bottom: 1px solid #f8fafc; }

/* ESTILIZAÇÃO DA VISUALIZAÇÃO EM LISTA */
.lista-container { width: 95%; max-width: 600px; margin: 0 auto; background: #fff; border-radius: 12px; overflow: hidden; color: #1f2937; }
.tabela-times { width: 100%; border-collapse: collapse; }
.tabela-times td { padding: 12px 10px; vertical-align: middle; border-bottom: 1px solid #f1f5f9; }
.td-posicao { font-family: 'Teko'; font-size: 22px; font-weight: 700; color: #94a3b8; text-align: center; width: 45px; }
.td-escudo img { width: 42px; height: 42px; object-fit: contain; }
.td-nome { font-weight: 800; font-size: 14px; text-transform: uppercase; }
.td-pontos { text-align: right; padding-right: 15px !important; }
.pontuacao-total { font-weight: 900; font-size: 17px; display: block; }
.detalhes-lista { font-size: 10px; color: #64748b; font-weight: 600; text-transform: uppercase; }

.status-lider { background: #dcfce7 !important; }
.status-rebaixamento { background: #fee2e2 !important; }
.titulo-serie { text-align: center; margin: 30px 0 15px; }
.badge-serie { display: inline-block; background: var(--orange); color: #000; font-weight: 900; font-size: 18px; padding: 6px 20px; border-radius: 999px; }
</style>
</head>
<body onclick="fecharTodosCards()">

<div class="header">
  <div class="header-topo-mobile">
    <img src="./CARTOLA.png" class="logo-campeonato">
    <div class="titulo-principal">TAÇA NATTOS - 2026</div>
  </div>
  <div class="header-controles-mobile">
    <div class="toggle-visual">
      <button class="toggle-btn ativo" id="btnCampo" onclick="mudarVisual('campo')">
        <svg class="icon-vertical" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect x="2" y="5" width="20" height="14" rx="2"></rect><line x1="12" y1="5" x2="12" y2="19"></line><circle cx="12" cy="12" r="2.5"></circle></svg>
      </button>
      <button class="toggle-btn" id="btnLista" onclick="mudarVisual('lista')">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect x="4" y="3" width="16" height="18" rx="2"></rect><rect x="9" y="1" width="6" height="4" rx="1"></rect><line x1="8" y1="10" x2="16" y2="10"></line><line x1="8" y1="14" x2="16" y2="14"></line></svg>
      </button>
    </div>
    <div class="badge-rdd">
      <div class="bola-rdd">RDD</div>
      <div id="info-rdd-topo" class="texto-rdd">-- / 19</div>
    </div>
  </div>
</div>

<div id="containerA">
  <div class="titulo-serie"><span class="badge-serie">SÉRIE A</span></div>
  <div id="displayA"></div>
</div>

<div id="containerB">
  <div class="titulo-serie"><span class="badge-serie">SÉRIE B</span></div>
  <div id="displayB"></div>
</div>

<script src="tabela.js"></script>

<script>
/* COORDENADA DO TROFÉU */
const posTrofeu = { t: 2, l: 51 }; 

/* COORDENADAS DOS TIMES POR COLOCAÇÃO */
const posCampo = [
    { t: 13, l: 50 }, // 1º COLOCADO
    { t: 18, l: 25 }, // 2º COLOCADO
    { t: 20, l: 75 }, // 3º COLOCADO
    { t: 40, l: 50 }, // 4º COLOCADO
    { t: 45, l: 20 }, // 5º COLOCADO
    { t: 45, l: 80 }, // 6º COLOCADO
    { t: 68, l: 15 }, // 7º COLOCADO
    { t: 70, l: 50 }, // 8º COLOCADO
    { t: 68, l: 85 }, // 9º COLOCADO
    { t: 90, l: 50 }  // 10º COLOCADO
];

let modoAtivo = 'campo';

/* CÁLCULO DE PONTUAÇÃO ACUMULADA E HISTÓRICO */
function processarDados(historicoBruto) {
    const agrupado = {};
    let rodadaMaxima = 0;

    historicoBruto.forEach(item => {
        if (!agrupado[item.nome]) {
            agrupado[item.nome] = { 
                nome: item.nome, 
                total: 0, 
                somaRDD: 0, 
                somaRE: 0, 
                somaPEN: 0, 
                ultimaRDDVal: 0,
                rodadas: [] 
            };
        }
        agrupado[item.nome].somaRDD += item.val;
        agrupado[item.nome].somaRE += item.re;
        agrupado[item.nome].somaPEN += item.pen;
        agrupado[item.nome].rodadas.push(item);
        
        if(item.rdd > rodadaMaxima) rodadaMaxima = item.rdd;
    });

    const listaFinal = Object.values(agrupado).map(time => {
        time.total = (time.somaRDD + time.somaRE) - time.somaPEN;
        const ultimaRodadaObj = time.rodadas.reduce((prev, current) => (prev.rdd > current.rdd) ? prev : current);
        time.ultimaRDDVal = ultimaRodadaObj.val;
        time.rodadas.sort((a, b) => b.rdd - a.rdd);
        return time;
    });

    listaFinal.sort((a, b) => b.total - a.total);
    return { ranking: listaFinal, rdd: rodadaMaxima };
}

const resA = processarDados(typeof historicoSerieA !== 'undefined' ? historicoSerieA : []);
const resB = processarDados(typeof historicoSerieB !== 'undefined' ? historicoSerieB : []);
const serieAData = resA.ranking;
const serieBData = resB.ranking;

document.getElementById('info-rdd-topo').innerText = `${resA.rdd.toString().padStart(2, '0')} / 19`;

/* FECHAR CARDS DE DETALHES */
function fecharTodosCards() {
  document.querySelectorAll('.pop-detalhes').forEach(c => c.style.display = 'none');
}

/* ABRIR CARD E APLICAR Z-INDEX MÁXIMO NO CONTAINER DO TIME */
function alternarCard(e, id) {
  e.stopPropagation();
  fecharTodosCards();
  
  // RESETA Z-INDEX DE TODOS OS CARDS ANTES DE ABRIR O NOVO
  document.querySelectorAll('.card-time').forEach(el => el.style.zIndex = "10");
  
  const card = document.getElementById('pop-' + id);
  if(card) {
      card.style.display = 'block';
      // ELEVA O CARD RODADAS PARA FICAR ACIMA DOS OUTROS ELEMENTOS
      card.parentElement.style.zIndex = "1000";
  }
}

/* RENDERIZAÇÃO DE COMPONENTE VISUAL */
function renderSeção(id, data, isA) {
  const container = document.getElementById(id);
  container.innerHTML = "";

  if(modoAtivo === 'campo') {
    const campoDiv = document.createElement("div");
    campoDiv.className = "campo";
    campoDiv.innerHTML += `<img src="./TROFEU_NATTOS.png" class="trofeu-campo" style="top:${posTrofeu.t}%; left:${posTrofeu.l}%">`;

    data.forEach((time, i) => {
      const p = posCampo[i];
      const idUnico = id + i;
      let bClass = (isA && i >= 8) ? "badge-rebaixamento" : (!isA && i <= 1) ? "badge-lider" : "";

      if(i === 9) campoDiv.innerHTML += `<img class="garcom" src="./GARCONS/${time.nome}.png" style="top:${p.t}%; left:${p.l}%">`;

      const linhasHistorico = time.rodadas.map(r => `
          <div class="pop-grid-row">
            <span>${r.rdd}</span>
            <span style="color:#2563eb">${r.val.toFixed(2)}</span>
            <span style="color:#16a34a">${r.re.toFixed(2)}</span>
            <span style="color:#dc2626">${r.pen.toFixed(2)}</span>
          </div>
      `).join('');

      campoDiv.innerHTML += `
        <div class="card-time" style="top:${p.t}%; left:${p.l}%">
          <div class="pop-detalhes" id="pop-${idUnico}">
             <b>${time.nome.replace(/_/g, ' ')}</b>
             <div class="pop-grid-header">
                <span>RD</span><span>VAL</span><span>RE</span><span>PEN</span>
             </div>
             ${linhasHistorico}
          </div>
          <div class="posicao-campo">${i+1}</div>
          <img class="logo-campo" src="./ESCUDOS/${time.nome}.png">
          <div class="badge-pontos-campo ${bClass}" onclick="alternarCard(event, '${idUnico}')">
            ${time.total.toFixed(2)}
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
          </div>
        </div>`;
    });
    container.appendChild(campoDiv);
  } else {
    /* RENDERIZAÇÃO DA TABELA */
    let tabela = `<div class="lista-container"><table class="tabela-times">`;
    data.forEach((time, i) => {
      let rClass = (isA && i >= 8) ? "status-rebaixamento" : (!isA && i <= 1) ? "status-lider" : "";
      let iconePos = i === 0 ? `<img src="./TROFEU_NATTOS.png" style="width:20px; vertical-align:middle;">` : i+1;
      
      tabela += `<tr class="${rClass}">
        <td class="td-posicao">${iconePos}</td>
        <td class="td-escudo"><img src="./ESCUDOS/${time.nome}.png"></td>
        <td class="td-nome">${time.nome.replace(/_/g, ' ')}</td>
        <td class="td-pontos">
          <span class="pontuacao-total">${time.total.toFixed(2)}</span>
          <span class="detalhes-lista">ULT. RDD: ${time.ultimaRDDVal.toFixed(2)} | RE: ${time.somaRE.toFixed(2)} | PEN: ${time.somaPEN.toFixed(2)}</span>
        </td></tr>`;
    });
    container.innerHTML = tabela + `</table></div>`;
  }
}

/* TROCAR MODO DE VISUALIZAÇÃO */
function mudarVisual(tipo) {
  modoAtivo = tipo;
  document.getElementById('btnCampo').classList.toggle('ativo', tipo === 'campo');
  document.getElementById('btnLista').classList.toggle('ativo', tipo === 'lista');
  renderSeção("displayA", serieAData, true);
  renderSeção("displayB", serieBData, false);
}

mudarVisual('campo');
</script>
</body>
</html>





